<div dir="rtl">

# سوال اول

## بخش دوم 

شکل زیر نمایش گزارش sonar برای یکی از پروژه‌های داخل سیستم محلی می‌باشد. همانطور که مشخص می‌باشد این کد دارای ۳ خطای smell code می‌باشد. در ادامه به برطرف کردن آنها پرداخته خواهد شد:
![image 1-1](./images/1-1.png)

### بررسی code smells اول:
![image 1-2](./images/1-2.png)
 در اینجا گفته شده است که در طول برنامه چندین بار از مقدار "data.txt" استفاده شده است و بهتر است با تعریف کردن یک const ، از آن به جای این مقدار استفاده شود تا در آینده اگر نیاز به refactor کردن کد وجود داشت، لازم نباشد که در تمام طول برنامه به دنبال این string باشیم و تنها با تغییر مقدار const به هدف خود دست پیدا کنیم. و در واقع fair of change کاهش پیدا کند.

### بررسی code smells دوم:
![image 1-3](./images/1-3.png)
 در اینجا گفته شده است که در Cognitive Complexity کد زیاد می‌باشد، که این می‌تواند فهم جریان برنامه را سخت‌تر کند. و توابعی که دارای پیچیدگی شناختی بیشتری هستند، نگهداریشان دشوارتر است، برای حل این مشکل نیز به دلیل آنکه بخش زیر بارها در کد تکرار شده است، می‌توان تابعی تعریف کرد که عملکرد آن را انجام دهد و تمامی if های مشابه با آن حذف شوند. برای این کار تابع checkErr تعریف شد که با گرفتن interface error عملکرد مورد نظر شرط زیر را انجام می‌دهد و تمامی if های مشابه با ساختار زیر حذف و به جای آنها تابع تازه ایجاد شده فراخوانی شد.

 ```go
if err != nil {
       log.Fatal(err)
   }
```

### بررسی code smells سوم:
![image 1-4](./images/1-4.png)
در اینجا داخل بلاک else خالی می‌باشد که به نظر می‌رسد کدی قرار بوده در آن نوشته شود که فراموش شده است، با بررسی مجدد ساختار if بالا متوجه شدم که می‌توان کل ساختار را به صورت زیر بازنویسی کرد و دیگر بلوک خالی نیز نخواهیم داشت.

 ```go
if strings.ToLower(new) == "no" || strings.ToLower(new) == "n" {
    return old
} else {
    return new
}
```
در نهایت پس از بررسی و رفع تمامی code smells ها و اجرای مجدد کد پس از هر بار اصلاح، تمامی موارد برطرف شده و گزارش نهایی به همراه نمودار آن به‌صورت زیر می‌باشد.
![image 1-5](./images/1-5.png)

---
<br>

## بخش سوم 
پروژه‌ی انتخابی از لینک قرار داده شده در صورت سوال، در رو به رو آورده شده است:
[لینک پروژه](https://github.com/globocom/secDevLabs/tree/master/owasp-top10-2021-apps/a2/snake-pro)
<br><br>
همانطور که از نتایج اولیه‌ی sonarqube مشخص می‌باشد، برای این پروژه، خطاهای زیر گزارش شده است:

![image 2-1](./images/2-1.png)

### ابتدا به بررسی باگ‌ها می‌پردازیم:
![image 2-2](./images/2-2.png)
باگ شماره‌ی ۱: در این باگ گزارش شده است که ویژگی lang به منظور شناسایی زبان پیش‌فرض یک سند مشخص شود. این کار باعث می‌شود که برنامه‌های دیگری مثل screen reader ها قادر باشند تا به شکل راحت تری صفحه‌ی مربوطه را بخوانند. همچنین به کاربر کمک خواهد کرد تا در صورت استفاده از extension های ترجمه کاربر بتواند تجربه‌ی بهتری داشته باشد و در نهایت rank سایت در موتورهای جستجو را نیز بهتر خواهد کرد.
برای حل این مشکل کافیست <html> را به <"html lang "en> تغییر دهیم.

---
<br>

![image 2-3](./images/2-3.png)
باگ شماره‌ی ۲ : در این باگ گزارش شده است که تعریف تگ title اهمیت دارد چرا که در نتایج موتورهای جستجو و همچنین در نوار بالایی مرورگرها نمایش داده خواهد شد.
برای حل این مشکل کافیست داخل تگ head  تگ مربوط به title را نیز تعریف کنیم ، در واقع به جای  تگ head  قرار دهیم: 

`<head><title>New Title</title>`

---
<br>

![image 2-4](./images/2-4.png)
باگ شماره‌ی ۳ :  در این باگ گزارش شده است که در HTML5 بسیاری از تگ‌ها deprecated شده‌اند، و برای اینکه تجربه‌ی کاربری بهتری به ارمغان بیاید ، نباید از تگ های deprecated شده استفاده کرد، بنابراین به جای استفاده از تگ center که deprecated شده است، باید از روش دیگری استفاده کرد.
برای حل این مشکل کافیست به جای استفاده از تگ center باید تگ div را به صورت زیر یادداشت کرد:

`<div class="card-content grey lighten-4" style="text-align:center">
`

---
<br>

![image 2-5](./images/2-5.png)
باگ شماره‌ی ۴: این باگ نیز مشابه با باگ شماره‌ی ۳ قابل رفع شدن می‌باشد.
برای حل این مشکل نیز کافیست تگ center را حذف کنیم و تگ div را به صورت زیر بازنویسی کنیم:

`<div class="card-content grey lighten-4" style="text-align:center">
`

---
<br>

![image 2-6](./images/2-6.png)
باگ شماره‌ی ۵ : در این باگ نیز گزارش شده است که بهتر است توضیحاتی برای محتوای جداول نوشته شود، و برای این کار یکی از بهترین روشها که توصیه می‌شود، استفاده از تگ caption داخل تگ table می‌باشد.
برای حل این مشکل نیز کافیست تگ caption  زیر را داخل تگ table بنویسیم.

---
<br>

### اکنون به بررسی hotspot security می‌پردازیم:
![image 2-7](./images/2-7.png)
در اینجا گفته شده است که استفاده از منابع خارجی داخل کد و عدم صحت سنجی آنها می‌تواند بر امنیت برنامه اثرگذار باشد، چرا که احتمال دارد منبع خارجی،‌ یک زمانی تغییر کند، که این تغییر می‌تواند خواسته و یا ناخواسته توسط یک مهاجم صورت بگیرد، در این صورت منبع خارجی مورد استفاده در برنامه دیگر منبع اولی نخواهد بود و ضمن این که می‌تواند مخرب نیز باشد، با این توضیح اگر قبل از آوردن محتوا، صحت سنجی انجام شود، میتواند جلو چنین مشکلاتی گرفته شود، بنابراین بهتر است از attribute integrity استفاده شود که با هش گرفتن از محتوای منبع خارجی و تطابق آن با محتوای منبع هنگام دسترسی به آن، در صورت یکسان نشدن محتوا، گنجاندن محتوا در برنامه را مسدود خواهد کرد.
برای حل این مشکل کافیست به جای آنکه در تگ script صرفا از src استفاده شود، ویژگی  integrity هم لحاظ شود، برای این کار کافیست با یکی از الگوریتمهای هش، محتوای منبع خارجی مورد قبول هش شود، و با قرار دادن مقدار هش شده کنار محتوا، صحت‌سنجی منبع قبل از گنجاندن آن در برنامه انجام شود، لذا کافیست هش src ای که در بالا گفته شده را برای نمونه به کمک 
[این سایت](https://www.srihash.org/) بدست آورده و به عنوان مقدار ویژگی integrity در کنار src داخل تگ script پاس بدهیم.


---
<br>

در نهایت پس از رفع باگها و hotspot security گفته شده، نتیجه‌ی گزارش به ‌صورت زیر می‌باشد:

![image 2-8](./images/2-8.png)
همچنین نمودار نیز پس از رفع هر کدام از باگها و اجرای مجدد کد، به صورت زیر می‌باشد:

![image 2-9](./images/2-9.png)

---
<br>

## بخش چهارم 
در گزارشات sonar دو دسته‌ی hotspot security , Vulnerability دارای تفاوت می‌باشند، در hotspot security بخش‌هایی از کد که می‌تواند منجر به آسیب‌پذیری امنیتی شود، مورد توجه قرار می‌گیرد، همانند چیزی که در بالا مشاهده کردیم که گنجاندن یک منبع خارجی، بدون صحت‌سنجی آن می‌تواند منجر به یک آسیب‌پذیری امنیتی شود. و یا به عنوان یک مثال دیگر، اگر password به صورت hard code , plain در کد قرار داده شود، می‌تواند منجر به یک آسیب‌پذیری امنیتی شود.

در مقابل در بخش vulnerability به ضعف های امنیتی برنامه اشاره دارد که بر اسکوپ برنامه اثرگذار است. برای مثال زمانی که شما از http به جای https استفاده می‌کند تا برای مثال اطلاعات user , pass را منتقل کنید، این یک ضعف امنیتی می‌باشد که به راحتی میتواند توسط مهاجم بهره‌برداری شود.

بنابراین باید گفت security hotspot در واقع توجهش به بخش‌هایی می‌باشد که می‌تواند منجر به بروز آسیب‌پذیری شود و در واقع یک خطر بالقوه را شامل می‌شود، حال آن که در vulnerability به بخش‌هایی از برنامه توجه دارد که عملا دارای یک ضعف امنیتی هستند و در واقع خطراتی هستند که بالفعل بوده و مهاجم میتواند به راحتی از آنها بهره‌برداری کند.

# سوال دوم

## بخش اول 

در این سناریو تمرکز بر کاربری می‌باشد که کاربری که قبلاً از درایوهای قابل جابجایی استفاده نمی‌کرده یا بعد از ساعت کاری کار نمی‌کرده اند، با این حال مشاهده می‌شود که این کاربر پس از ساعت کاری شروع به ورود به سیستم می‌کند، از یک درایو قابل جابجایی استفاده می‌کند و داده‌ها را در wikileaks.org آپلود می‌کند. و پس از مدت کوتاهی سازمان را ترک می کند. همانطور که مشخص است این کاربر با یک دیوایس خارجی اقدام به ذخیره‌سازی و سپس افشای اطلاعات سازمان می‌گیرد، نکته‌ی حائز اهمیت در این سناریو، رفتار خارج از عرف این کاربر نسبت به گذشته‌ی خود می‌باشد، که یا برخلاف عادت از یک درایو خارجی استفاده می‌کند و یا برخلاف رفتار خود که همواره در ساعت کاری مشغول فعالیت بوده است، در ساعتهای خارج از ساعت کاری به شرکت آمده است. و یکی از این پارامتر ها و یا هر دو پارامتر می‌تواند عاملی برای شناسایی رفتار مشکوک این کاربر باشد.
همانطور که در فایل 3.1-1.csv آورده شده است، داده های کاربری خاص که برای این سناریو صادق است مشخص شده است، برای تحلیل آن باید گفت، با رجوع به دیتاست logon.csv مشاهده می‌شود که کاربری که آیدی CSF0929 را دارا می‌باشد، دارای 304 رخداد مختلف می‌باشد و زمانهای ورود و خروج او همواره در ساعت کاری و بین 8 تا 17 بوده است. اما همانطور که در فایل سناریو نیز قابل مشاهده است، این کاربر در سه تاریخ مختلف که هر سه خارج از ساعت اداری بوده‌اند به وبسایت http://wikileaks.org دسترسی داشته است و طی زمانی به مراتب کوتاه‌تر از مقدار ساعت کاری فعالیت‌هایی داشته، که مهمترین آنها ارتباط با سایت بالا و آپلود داده بوده است و سپس از سازمان خارج شده است. لذا می‌توان گفت با توجه به صورت سناریوی مورد نظر، و رخ دادن یکی از پارامترهای مشکوک بالا،  کاربر CSF0929 شرایط این سناریو را دارا می‌باشد.
با توجه به این که تمرکز این سناریو بر رفتار گذشته‌ی کاربر و سابقه‌ی وی می‌باشد و یکی از روشهای شناسایی او نیز استفاده از همین پارامترها بود، باید گفت می‌توان کاربران مختلف را براساس ویژگی‌هایشان برچسب گذاری کرد، با برچسب‌گذاری کاربران براساس ویژگی آنها، که در اینجا این ویژگی می‌تواند ۱. عدم استفاده از دیوایس های جانبی، یا ۲. مراجعه به سازمان در ساعت‌های کاری و… در این صورت می‌توان در صورتی که کاربر زمانی خلاف رخدادهای گذشته خود عمل کند، هشداری برای مدیر سیستم ارسال شود، و در این زمان یا دسترسی به کارمند یا داده نشود و تا بررسی مدیر دسترسی غیر فعال بماند و یا دسترسی وجود داشته باشد ولی امکان استفاده از منابع مورد نظر تا زمانی که ادمین ، تایید نکرده است، انجام نشود. در مورد موفقیت بودن این روش باید گفت، این روش و به ویژه بحث دسته‌بندی کردن کاربران و چگونه تعیین کردن ویژگی ها که بهتر است توسط روشهای یادگیری ماشین انجام شود و نه به صورت دستی، اما نکته‌ی حائز اهمیت آنجاست که برای آنکه تحلیل و برچسب‌گذاری درستی صورت گیرد، نیاز به داده‌های زیادی می‌باشد، تا همانند نتیجه‌ای که ما در این سناریو گرفتیم، ماشین نیز بتواند هم رفتار گذشته‌ی کاربر را به خوبی یاد بگیرد، هم برچسب گذاری درستی انجام دهد، و در ادامه بحث اطلاع رسانی خواهد بود. لذا این روش برای سازمانهایی که داده‌هایی کمی را نگهداری می‌کنند و یا از رخدادهای گذشته‌ی کارمندان خود بهره نمی‌برند، نمی‌تواند روش مناسبی باشد، اما اگر داده‌های خوبی از رفتار کارمندان جمع‌آوری شده است می‌تواند روش خوبی باشد، البته با ذکر در نظر گرفتن هزینه‌ها و پیاده‌سازی الگوریتمهای مورد نظر و تخصیص منابع کافی. همچنین این روش برای کارمندان تازه‌وارد نیز چندان نمی‌تواند موثر واقع شود. 


## بخش دوم 

در این مورد چندین نکته را میتوان گفت  اگر بخواهیم تنها راه جلوگیری از نشت اطلاعات را صرفا به عهده‌ی هر شخص درون سازمان و احساس مسئولیت او نسبت به داده‌های دستگاه خود در نظر بگیریم، این روش اصلا روش مناسبی برای حفاظت از داده‌های سازمان نیست، اگر داده های سیستم هر شخص درون سازمان را به دو بخش تقسیم کنیم: داده های شخصی و داده‌های مرتبط با سازمان، قطعا رویکرد سازمان باید نسبت به هر کدام از این داده‌ها مختلف باشد، رویکرد سازمان در قبل داده‌های شخصی افراد، می‌تواند مطابق با راهکاری باشد که در بالا نوشته شده است، که تا حدی نیز می‌تواند موثر باشد چون هر شخص مسئولیت حفظ داده‌های خود را خواهد داشت، اما مسلما این رویکرد برای داده‌هایی که مرتبط با سازمان می‌باشد و امکان نشت آنها از سیستم اشخاص درون سازمان وجود دارد، اصلا مناسب نیست. چرا که فارغ از کارمندان ناراضی که ممکن است عمدا چنین سیاستی را به درستی اجرا نکنند، اعتماد کارمندان به یکدیگر، مهاجمان داخلی و خارجی و بسیاری از تهدیدات دیگر همگی می‌توانند باعث نقض چنین سیاستی شده و در نتیجه داده‌های سازمان که در سیستم شخص خاص بوده است را نشت دهد. ضمن اینکه تعریف نقش های مختلف و نظارت مدیران بالادستی اشخاص مختلف بر زیردستان خود نیز به درستی نمی‌تواند تعریف شود،‌ لذا روش مناسب نظارت یکپارچه و ادغام شده از بالا بر منابع و اطلاعات درون سازمان می‌باشد، نه تفویض آنها به کارمندان درون سازمان، آنها نهایتا تلاش کنند از داده‌های شخصی خود که مرتبط با سازمان نیست محافظت کنند.
همانطور که در این سناریو آمده است و در داده‌های 3.1-2.csv نیز مشخص است کاربر شروع به گشت و گذار در وب سایت های شغلی و درخواست استخدام از یک رقیب می کند. قبل از ترک شرکت، از یک درایو انگشت شست (با نرخ های قابل توجهی بالاتر از فعالیت قبلی خود) برای سرقت داده ها استفاده می کنند. در فایل مربوط به این سناریو نیز به وضوح اتصال و قطع اتصال دستگاه توسط این کاربر در فاصله‌ زمانی‌های بسیار کوتاهی ثبت شده است. 


## بخش سوم
شاید می‌توان گفت مهمترین داده‌ای که می‌تواند موثر باشد، داده‌هایی هست که دسترسی به منابع مختلف داخلی و خارجی را مشخص می‌کند، resource هایی که کاربران به آنها دسترسی پیدا می‌کنند مهمترین داده ها برای تشخیص حملات و بررسی رفتار مختلف کاربران می‌باشد، برای مثال فرض کنید اگر ما داده‌های logon کاربران را در نظر بگیریم، مسلما نتایجی که مدنظر ما هست را به اندازه‌ی دسترسی به resource های مختلف در اختیار ما قرار نخواهد داد، همچنین باید گفت دسترسی به resource ها در درجه‌ی اول resource های غیرفیزیکی، مانند اتوماسیون های سازمان، وبسایت‌های مختلف و… می‌باشد، با جمع آ‌وری آنها می‌توان تمامی اتصالات کاربران به resource های مختلف را دنبال کرد، در گام بعد جمع‌اوری resource های فیزیکی هم می‌تواند مفید باشد.
</div>
